---
title             : "Factorial structure of the indicators in Big Five Plus Inventory"
shorttitle        : "Factorial structure of the indicators in Big Five Plus Inventory"
author: 
  - name          : "Cristian Opariuc-Dan"
    affiliation   : "1,2,3"
    corresponding : yes    # Define only one corresponding author
    address       : "Ovidius University Campus, Aleea Universității, No. 2, Constanța, Romania"
    email         : "copariuc@gmail.com"
    role:         # Contributorship roles (e.g., CRediT, https://casrai.org/credit/)
      - Conceptualization
      - Writing - Original Draft Preparation
      - Writing - Data analysis
  - name          : "Gabriela Nicuță"
    affiliation   : "3"
    role:
      - Writing - Systematic review
      - Writing - Data analysis
      - Proofreading
  - name          : "Ticu Constantin"
    affiliation   : "3"
    role:
      - Data provider
      - Writing - Review & Editing
affiliation:
  - id            : "1"
    institution   : "Ovidius University, Constanta, Romania"
  - id            : "2"
    institution   : "Bucharest University, Bucharest, Romania"
  - id            : "3"
    institution   : "Al. I. Cuza University, Iassy, Romania"
authornote: |
  
  The authors thanks Prof. Dr. Constantin Ticu and the PsihoProfile team for making available over 14000 data used in this analysis.
  
  The data in this paper comes form the Romanian version of BigFive Plus inventory[@BigFive-plus], being collected online through the [PsihoProfile site](http://www.psihoprofile.ro/)
abstract: |
  TO BE DONE AT THE END
keywords          : "BigFive, Confirmatory Factor Analysis, Reliability analysis"
wordcount         : "X"
bibliography      : ["r-references.bib", "Big Five Plus.bib"]
link-citations    : TRUE
biblio-style      : "apalike"
floatsintext      : no
figurelist        : no
tablelist         : no
footnotelist      : no
linenumbers       : yes
mask              : no
draft             : yes
documentclass     : "apa7"
csl               : "apa.csl"
classoption       : "man"
output            : papaja::apa6_pdf
editor_options: 
  chunk_output_type: console
header-includes:
  - \usepackage[document]{ragged2e}
---

```{r setup, include = FALSE}
  # Including necessary libraries
  library(papaja); library(stargazer); library(epiDisplay)
  #library(psych); library(nortest); library(dplyr)
  #library(purrr); #library(lavaan)

  # Including references file for R libraries
  r_refs("r-references.bib")
```

```{r analysis-preferences}
  # Seed for random number generation
  set.seed(4482)
  knitr::opts_chunk$set(cache.extra = knitr::rand_seed)
  # Import and prepare dataset
  load("Date.Rdata")
```

# Methods
\justify
In this paper we aimed to conduct an exploratory study on the **analysis of how the theoretical Big Five model is supported by data**. The volume of data collected, even is it is very large and gives power to the study, does not constitute a representative sample because no sampling technique was used, but represents the results of tests performed with the Big Five Plus Personality Inventory [@BigFive-plus] during 2015-2020 on the population of Romania. The answers resulted either from an online administration using the [PsihoProfile site](http://www.psihoprofile.ro/), or from the classic administration, pencil-paper, followed by the introduction of the answers in the platform in order to automatically rate and generate assessment's protocols. 

La nivel de bază, variabilele manifeste reprezintă cei 244 de itemi dihotomici ai Inventarului de Personalitate Big Five Plus, analiza intrând în domeniul analizelor factoriale confirmatorii folosindu-se indicatori categoriali, mai precis dihotomici, iar acest lucru implică o abordare specifică.

Modelul nu prevede existența unor indicatori încărcați de mai mult de un singur factor latent, fiecare factor latent încărcând 8 indicatori, prin urmare și aceștia vor reprezenta variabile latente categoriale, deoarece o amplitudine de 8 puncte nu-i poate califica drept variabile continui.

Factorii latenți care încarcă cei 8 indicatori sunt la rândul lor încărcați de una dintre cele 5 dimensiuni Big Five, rezultând un model de analiză factorială de ordin secund [@Byrne-2010] cu factori de ordin secund necorelați, aceștia fiind reprezentați după cum urmează:

+ **Extraversion**, variabilă latentă exogenă care încarcă un număr de 6 variabile latente endogene: *Friendliness*, *Gregariousness*, *Assertiveness*, *Activity level*, *Excitement seeking* și *Cheerfulness*.

+ **Agreeableness**, variabilă latentă exogenă care încarcă un număr de 6 variabile latente endogene: *Trust*, *Morality*, *Altruism*, *Cooperation*, *Modesty* și *Sympathy*.

+ **Neuroticism**, variabilă latentă exogenă care încarcă un număr de 6 variabile latente endogene: *Anxiety*, *Anger*, *Depression*, *Timidity*, *Immoderation* și *Vulnerability*.

+ **Conscientiousness**, variabilă latentă exogenă care încarcă un număr de 6 variabile latente endogene: *Self-efficacy*, *Orderliness*, *Dutifulness*, *Achievement-striving*, *Self-discipline* și *Cautiousness*.

+ **Openness to experience**, variabilă latentă exogenă care încarcă un număr de 6 variabile latente endogene: *Imagination*, *Artistic interests*, *Emotionality*, *Adventurousness*, *Intellect* și *Liberalism*.

## Participants
```{r participants, echo = F, include = F}
  # Computing data
  gender <- tab1(date$gen, graph = F)
  studies <- tab1(date$studii, graph = T)
  # Returning values - n
  n <- gender$output.table[3]
  # Returning values - n by gender
  n.male <- gender$output.table[1]
  n.male.prc <- gender$output.table[4]
  n.female <- gender$output.table[2]
  n.female.prc <- gender$output.table[2]
  # Returning values - n by educational level
  n.st.lic <- studies$output.table[7]
  n.st.lic.prc <- studies$output.table[18]
  n.st.hsc <- studies$output.table[5]
  n.st.hsc.prc <- studies$output.table[16]
  n.st.mst <- studies$output.table[8]
  n.st.mst.prc <- studies$output.table[19]
  n.st.phs <- studies$output.table[6]
  n.st.phs.prc <- studies$output.table[17]
  n.st.art <- studies$output.table[4]
  n.st.art.prc <- studies$output.table[15]
  n.nost <- studies$output.table[10]
  n.nost.prc <- studies$output.table[21]
```
A total of `r n` protocols were collected **(n=`r n`)**, administered to a number of `r n.male` *males* (`r n.male.prc `%) and `r n.female` *females* (`r n.female.prc`%), most of them being *university graduates* (`r n.st.lic`, representing `r n.st.lic.prc`%), followed by *high school graduated* (`r n.st.hsc`, representing `r n.st.hsc.prc`%) and the persons with *master's degrees* (`r n.st.mst`, representing `r n.st.mst.prc`%). The research group also contains graduates of *post-secondary schools* (`r n.st.phs`, representing `r n.st.phs.prc`%) and graduates of *arts and crafts schools* (`r n.st.art`, representing `r n.st.art.prc`%), the other categories being much less represented.
```{r gender, results='asis'}
  stargazer::stargazer(gender$output.table, type = "latex", 
                       header = F, float = T, title = "Participants's gender")
```
```{r education, results='asis'}
    stargazer::stargazer(studies$output.table, type = "latex", 
                       header = F, float = T,  title = "Participants's educational level")
```

Remarcăm, totuși, numărul mare al persoanelor care nu au precizat nivelul de studii (`r n.nost`, reprezentând `r n.nost.prc`%), acestea urmând a fi eliminate din analizele ce presupun utilizarea acestei variabile.

## Material
Instrumentul folosit este Inventarul de Personalitate Big Five Plus [@BigFive-plus], datele fiind colectate în perioada 2015-2020 (n=`r gender$output.table[3]`).  Instrumentul,construit și validat pe populația românească,   permite evaluarea celor cinci meta-factori ai personalității (Extraversiune, Agreabilitate, Nevrozism, Conștiinciozitate și Deschidere), dar și a 30 de fațete subordonate acestora. Invetarul conține 240 de itemi dihotomici, câte 48 pentru evaluarea fiecăruia dintre cei cinci factori principali și câte opt pentru evaluarea celor 30 de fațete. Persoana este instruită să aleagă dintre două aserțiuni pe aceea care o descrie cel mai bine (e.g. *Atunci când sunt la o petrecere: (a) sunt în mijlocul acţiunii, înconjurat de ceilalți ; (b) prefer să stau de o parte şi să observ.*). Cele două variante de răspuns reprezintă extreme ale dimensiunii psihologice vizate și se doresc a fi similare din perspectiva dezirabilității sociale. Timpul mediu de completare a chestionarului este de 35 de minute. 

## Procedure
Analiza va presupune studiul inițial al consistenței interne, pentru fiecare scală folosindu-se metoda \(\alpha\) Cronbach [@Cronbach-1951] în vederea calculului coeficientului de consistență internă \(\alpha\) (Guttman \(\lambda\)~3~), dar și al coeficienților ierarhici de saturație \(\omega\) [@Zinbarg-2007] deoarece deoarece instrumentul nu este unul unifactorial. 
În vederea analizei de structură internă și a adecvării la model unidimensional, vom testa, la nivelul fiecărei fațete, atât acest model, cât și două modele alternative, cu două și 3 sub-componente în vederea identificării unei structuri axiale (prezența unor scale cu sub-componente - lumpyness).

Vom testa apoi modelul în care factorul latent încarcă cei 8 indicatori, pentru fiecare dintre cele 6 fațete ale unei dimensiuni, și existența dimensiunii comune pentru toți cei 6 factori latenți.

În urma interpretării parametrilor și a diagnosticului modelelor acestea vor fi respecificate, identificându-se, dacă este cazul, modele explicative mai bune.

## Data analysis
Toate analizele s-au realizat folosind limbajul R versiunea `r getRversion()` și următoarele pachete: `r cite_r("r-references.bib")`. 

# Results

**În prima fază** vom prezenta comparativ analizele autorilor privind consistența internă utilizându-se **metoda alpha Cronbach a fidelității tau-echivalente** [@Cronbach-1951], incluzând atât indicatorii globali, cât și cei defalcați în funcție de genul biologic și de modalitatea de administrare. Analiza s-a realizat utilizându-se pachetul **„psych”** [@R-psych], plecându-se de la condiția itemilor cumulativi, scorul total rezultând în urma adunării celor 8 itemi (amplitudinea teoretică de 8 puncte) cu identificarea varianțelor negative ale itemilor și recodare automată și utilizând o reeșantionare neparametrică folosind 100 de eșantioane în vederea verificării stabilității parametrilor.

**În cea de-a doua fază** se vor calcula coeficienții ierarhici de saturație *\(\omega\)h* [@Zinbarg-2007], efectuându-se o analiză ierarhică a componentelor principale cu rotație oblică *(oblimin)* pe baza unei matrici de corelații tetrachorice cu inversarea automată a itemilor ce prezintă covarianțe negative cu factorul general, apoi aplicarea transformării Schmid Leiman asupra acesteia, testându-se astfel un număr de două modele în vederea identificării unei potențiale structuri „lumpyness”: **primul**, în care presupunem că itemii sunt încărcați de trei sub-componente ale factorului general, **al doilea**, în care vom pleca de la ipoteza în care itemii sunt încărcați de două sub-componente ale factorului general, iar în acest caz vom trata trei situații: (1) încărcările factorului general vor fi redistribuite egal pe cele două subcomponente, (2) încărcările factorului general vor fi echivalate cu cele ale primei sub-componente și (3) încărcările factorului general vor fi echivalate cu ale celei de-a doua sub-componentă.

## Confirmatory Factor Analisys
Analiza  Inventarul BigFive Plus va fi realizată după un model clasic de analiză factorială confirmatorie cu factori de ordin secund necorelați, ce va fi analizat folosindu-se pachetul **lavaan** [@R-lavaan]. Deoarece indicatorii sunt dihotomici, vom folosi *metoda estimării pragurilor categoriilor de răspuns* în care fiecare indicator devine încărcat în factor latent și determină un răspuns activ (1-Da) dacă depășește valoarea prag a sa, determinată de poziția itemului pe continuumul factorului latent. Drept estimator vom folosi unul din categoria metodelor bazate pe cele mai mici pătrate, mai precis **„WLSM”**, ce utilizează doar diagonala matricii ponderate „W” (**„DWLS”**) și folosind, la testele statistici, mediile ajustate. În vederea testării potrivirii globale s-a folosit versiunea „Satorra Bentler” a testului \(\chi\)^2^, ajustându-se mediile [@Skrondal-2005].

### Extraversion
```{r sem-extra, echo=F, include=F}
  source("04 - CFA - Extraversion.R")
  # Analiza modelului global
  nr.param <- as.numeric(extraversion.ini$FIT["npar"])
  df <- as.numeric(extraversion.ini$FIT["df.scaled"])
  chi.sq <- as.numeric(extraversion.ini$FIT["chisq.scaled"])
  p.val <- as.numeric(extraversion.ini$FIT["pvalue.scaled"])
  rmsea <- as.numeric(extraversion.ini$FIT["rmsea"])
  rmsea.p <- as.numeric(extraversion.ini$FIT["rmsea.pvalue"])
  rmsea.ci.lo <- as.numeric(extraversion.ini$FIT["rmsea.ci.lower"])
  rmsea.ci.hi <- as.numeric(extraversion.ini$FIT["rmsea.ci.upper"])
  tli <- as.numeric(extraversion.ini$FIT["tli.scaled"])
  srmr <- as.numeric(extraversion.ini$FIT["srmr"])
  
  # Analiza parametrilor - Factorul cel mai puternic incarcat
  b_high <- extraversion.ini$PE[which(extraversion.ini$PE$lhs == "Extraversion" & extraversion.ini$PE$rhs == "Gregariousness" & extraversion.ini$PE$op == "=~"), 5]
  beta_high <- extraversion.ini$PE[which(extraversion.ini$PE$lhs == "Extraversion" & extraversion.ini$PE$rhs == "Gregariousness" & extraversion.ini$PE$op == "=~"), 11]
  r_high <- extraversion.ini$PE[which(extraversion.ini$PE$lhs == "Gregariousness" & extraversion.ini$PE$op == "r2"), 5]
  
  # Analiza parametrilor - Factorul cel mai slab incarcat
  b_low <- extraversion.ini$PE[which(extraversion.ini$PE$lhs == "Extraversion" & extraversion.ini$PE$rhs == "Excitement" & extraversion.ini$PE$op == "=~"), 5]
  beta_low <- extraversion.ini$PE[which(extraversion.ini$PE$lhs == "Extraversion" & extraversion.ini$PE$rhs == "Excitement" & extraversion.ini$PE$op == "=~"), 11]
  r_low <- extraversion.ini$PE[which(extraversion.ini$PE$lhs == "Excitement" & extraversion.ini$PE$op == "r2"), 5]
  
  # Analiza itemilor problematici
   I7.N <- extraversion.ini$PE[which(extraversion.ini$PE$lhs == "I7" & extraversion.ini$PE$op == "r2"), 3]
  I7.R <- extraversion.ini$PE[which(extraversion.ini$PE$lhs == "I7" & extraversion.ini$PE$op == "r2"), 5]
  I7.B <- extraversion.ini$PE[which(extraversion.ini$PE$rhs == "I7" & extraversion.ini$PE$op == "=~"), 5]
  I7.Beta <- extraversion.ini$PE[which(extraversion.ini$PE$rhs == "I7" & extraversion.ini$PE$op == "=~"), 11]
  
  I28.N <- extraversion.ini$PE[which(extraversion.ini$PE$lhs == "I28" & extraversion.ini$PE$op == "r2"), 3]
  I28.R <- extraversion.ini$PE[which(extraversion.ini$PE$lhs == "I28" & extraversion.ini$PE$op == "r2"), 5]
  I28.B <- extraversion.ini$PE[which(extraversion.ini$PE$rhs == "I28" & extraversion.ini$PE$op == "=~"), 5]
  I28.Beta <- extraversion.ini$PE[which(extraversion.ini$PE$rhs == "I28" & extraversion.ini$PE$op == "=~"), 11]
  
  I31.N <- extraversion.ini$PE[which(extraversion.ini$PE$lhs == "I31" & extraversion.ini$PE$op == "r2"), 3]
  I31.R <- extraversion.ini$PE[which(extraversion.ini$PE$lhs == "I31" & extraversion.ini$PE$op == "r2"), 5]
  I31.B <- extraversion.ini$PE[which(extraversion.ini$PE$rhs == "I31" & extraversion.ini$PE$op == "=~"), 5]
  I31.Beta <- extraversion.ini$PE[which(extraversion.ini$PE$rhs == "I31" & extraversion.ini$PE$op == "=~"), 11]
  
  I37.N <- extraversion.ini$PE[which(extraversion.ini$PE$lhs == "I37" & extraversion.ini$PE$op == "r2"), 3]
  I37.R <- extraversion.ini$PE[which(extraversion.ini$PE$lhs == "I37" & extraversion.ini$PE$op == "r2"), 5]
  I37.B <- extraversion.ini$PE[which(extraversion.ini$PE$rhs == "I37" & extraversion.ini$PE$op == "=~"), 5]
  I37.Beta <- extraversion.ini$PE[which(extraversion.ini$PE$rhs == "I37" & extraversion.ini$PE$op == "=~"), 11]
  
  I30.N <- extraversion.ini$PE[which(extraversion.ini$PE$lhs == "I30" & extraversion.ini$PE$op == "r2"), 3]
  I30.R <- extraversion.ini$PE[which(extraversion.ini$PE$lhs == "I30" & extraversion.ini$PE$op == "r2"), 5]
  I30.B <- extraversion.ini$PE[which(extraversion.ini$PE$rhs == "I30" & extraversion.ini$PE$op == "=~"), 5]
  I30.Beta <- extraversion.ini$PE[which(extraversion.ini$PE$rhs == "I30" & extraversion.ini$PE$op == "=~"), 11]
  
  # Analiza modelului respecificat
  r.df <- as.numeric(extraversion.r$FIT["df.scaled"])
  r.chi.sq <- as.numeric(extraversion.r$FIT["chisq.scaled"])
  r.p.val <- as.numeric(extraversion.r$FIT["pvalue.scaled"])
  r.rmsea <- as.numeric(extraversion.r$FIT["rmsea"])
  r.rmsea.p <- as.numeric(extraversion.r$FIT["rmsea.pvalue"])
  r.rmsea.ci.lo <- as.numeric(extraversion.r$FIT["rmsea.ci.lower"])
  r.rmsea.ci.hi <- as.numeric(extraversion.r$FIT["rmsea.ci.upper"])
  r.tli <- as.numeric(extraversion.r$FIT["tli.scaled"])
  r.srmr <- as.numeric(extraversion.r$FIT["srmr"])
  
```
Varianța celor 48 de itemi dihotomici explicată de cei 6 factori latenți a căror varianță, mai apoi, va fi explicată de un factor de ordin doi, mai exact de **dimensiunea Extraversiune**, în urma analizei a generat o soluție stabilă după 29 de iterații, estimându-se un număr `r nr.param` parametri liberi, pentru o estimare validă fiind necesare minimum `r nr.param * 10` observații, ideal `r nr.param * 20` observații, condiția volumului lotului de cercetare fiind îndeplinită.

Modelul global cu un singur factor latent de ordin doi nu este însă susținut în mod corespunzător de date *(Robust \(\chi\)^2^~(`r df`)~=`r chi.sq`, p=`r p.val`)*, testul de potrivire a modelului eșuând și respingându-se ipoteza nulă **H~0~:** *Nu există nicio discrepanță statistic semnificativă între covarianțele stipulate la nivelul populației și covarianțele estimate de model.* Erorile de aproximare sunt însă acceptabile *(RMSEA=`r rmsea`, p=`r rmsea.p`, CI~90%~=`r rmsea.ci.lo` - `r rmsea.ci.hi`)*, chiar dacă ipoteza nulă de potrivire **H~0~:** *Reziduurile standardizate dintre covarianțele rezultate din date și matricea ipotetică de covarianțe sunt nule* este respinsă, valoarea arătând eșecul testul de nepotrivire (\(\epsilon\)>.10) și reziduuri standardizate statistic semnificative între covarianțele rezultate din date și matricea ipotetică de covarianțe.

Indicele Tucker-Lewis de comparare cu modelul de bază *(Robust TLI=`r tli`, SRMR=`r srmr`)* arată că modelul se îmbunătățește cu `r tli * 100`% în comparație cu modelul nul, în condițiile în care indicatorul standardizat al reziduurilor are o valoare ușor ridicată.

Din cauza unei probleme de identificare empirică și care a generat o matrice neinversabilă, erorile standard ale estimării parametrilor nu au putut fi calculate, prin urmare nici testele statistice, așadar parametrii vor fi apreciați pe baza valorilor nestandardizate și standardizate.

**Extraversiunea**, ca factor latent de ordin doi, încarcă cel mai puternic factorul latent *Sociabilitate* (B=`r b_high`, \(\beta\)=`r beta_high`, R^2^=`r r_high`) și cel mai slab factorul latent *Excitabilitate* (B=`r b_low`, \(\beta\)=`r beta_low`, R^2^=`r r_low`), valorile varianței explicate și ale coeficientului de încărcare sugerând, de fapt, că *Excitabilitatea* nu reprezintă o fațetă a extraversiunii, cu atât mai mult cu cât cei 8 itemi sunt încărcați foarte bine de aceasta.

```{r EXT-Loading, results='asis'}
  apa_table(load.tbl.1, row.names = F, caption = "Loadings for Friendliness' latent trait")
  apa_table(load.tbl.2, row.names = F, caption = "Loadings for Gregariousness' latent trait")
  apa_table(load.tbl.3, row.names = F, caption = "Loadings for Assertiveness' latent trait")
  apa_table(load.tbl.4, row.names = F, caption = "Loadings for Activity's latent trait")
  apa_table(load.tbl.5, row.names = F, caption = "Loadings for Excitement's latent trait")
  apa_table(load.tbl.6, row.names = F, caption = "Loadings for Cheerfulness' latent trait")
```
În privința itemilor problematici, remarcăm itemul **`r I7.N`** încărcat foarte slab de factorul **Asertivitate** (B=`r I7.B`, \(\beta\)=`r I7.Beta`, R^2^=`r I7.R`), itemii **`r I28.N`, `r I31.N` și `r I37.N`** încărcați foarte slab de factorul **Activitate** (Itemul 28: B=`r I28.B`, \(\beta\)=`r I28.Beta`, R^2^=`r I28.R`, Itemul 31: B=`r I31.B`, \(\beta\)=`r I31.Beta`, R^2^=`r I31.R` și Itemul 37: B=`r I37.B`, \(\beta\)=`r I37.Beta`, R^2^=`r I37.R`), precum și itemul **`r I30.N`** încărcat foarte slab de factorul **Veselie** (B=`r I30.B`, \(\beta\)=`r I30.Beta`, R^2^=`r I30.R`)

Respecificând modelul prin eliminarea itemilor problematici și a factorului latent *Excitabilitate*, obținem o îmbunătățire a modelului în ce privește potrivirea globală (\(\chi\)^2^~(`r r.df`)~=`r r.chi.sq`, p=`r r.p.val`,  RMSEA=`r r.rmsea`, p=`r r.rmsea.p`, CI~90%~=`r r.rmsea.ci.lo` - `r r.rmsea.ci.hi` față de \(\chi\)^2^~(`r df`)~=`r chi.sq`, p=`r p.val`,  RMSEA=`r rmsea`, p=`r rmsea.p`, CI~90%~=`r rmsea.ci.lo` - `r rmsea.ci.hi`), însă noul model tot nu este susținut în mod corespunzător de datele observate.

Singurul aspect remarcabil îl reprezintă creșterea capacității explicative față de modelul nul la `r r.tli * 100`% (TLI=`r r.tli`, SRMR=`r r.srmr`) față de modelul inițial cu `r tli * 100`% (TLI=`r tli`, SRMR=`r srmr`).

# Discussion




\newpage

# References

\begingroup
\setlength{\parindent}{-0.5in}
\setlength{\leftskip}{0.5in}

<div id="refs" custom-style="Bibliography"></div>
\endgroup
